# Шифр Виженера

Источником кода в этом примере явились видео про то, [как взломать Пентагон](https://www.youtube.com/watch?v=W_UiFnsRoFA) из [Archakov Blog](https://www.youtube.com/channel/UCdldbhAwO16vjnDwACTs5gQ) и соответствующая [статья](https://archakov.im/post/horoshij-plohoj-zloj-sposob-projti-zadanie-ot-tjournal-al-fabank.html). В рассматриваемом алгоритме происходит следующее:

1. Функция получает 2 аргумента, строки с цифрами: **28,14,19,173,44,57** и **4,0,5,1,2,3**.
2. Преобразует строки в массив чисел.
3. Получает верный порядок индексов.
4. Поочередно заменяет «**%s**» на число, соответствующее по индексу.

Верный ответ: **44-19-57-173-14-28**, посмотрите [графическую репрезентацию](https://goo.gl/UtMWMm) алгоритма.

```js
const arr1 = '28,14,19,173,44,57'.split(',');
const arr2 = '4,0,5,1,2,3'.split(',');

let i = 0;
let arr3 = arr2.map(n => i = arr2[i]);
console.log(arr3);

let result = '%s-%s-%s-%s-%s-%s';
arr3.forEach(n => {
  result = result.replace('%s', arr1[n]);
});
console.log(result);
```

Меня лично насторожила приведенная ниже строка. В ней в каждый элемент нового массива помещается значение, извлекаемое по индексу из исходного массива, начиная с первого элемента, так как инициализируемое `i = 0`.

```js
let i = 0;
let arr3 = arr2.map(n => i = arr2[i]);
```

Если в первом элементом массива `arr2` стоит 0, всё замыкается в цикл, обнуляющий весь массив. Эквивалентом нотации в стрелочной функции является следующее:

```js
let i = 0;
let arr3 = arr2.map(
function(n) {
  return i = arr2[i];
});
```

Т.е. в возврате функции находится полноценное присвоение. Получается в `JS` можно возвращать не только выражение.

```js
const arr2 = '4,0,5,1,2,3'.split(',');

let i = 0;
// let arr3 = arr2.map(n => (i = arr2[i]));
let arr3 = arr2.map(
function(n) {
  console.log(n);
  return i = arr2[i];
});
console.log(arr3);
```

Проблематика упомянутой строки кода в том, что там не используется само значение элемента обрабатываемого исходного массива, все отлично работает и в таком виде:

```js
const arr2 = '4,0,5,1,2,3'.split(',');

let i = 0;
let arr3 = arr2.map(() => (i = arr2[i]));
console.log(arr3);
```

Для удобочитаемости, выполняемую над элементами массива функцию метода `map` я закрыл в скобки.

------

#### [JS узкие части](./00_JS_narrow_parts.md)